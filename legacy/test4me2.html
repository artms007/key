<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>FetchでPOST送信のテスト</title>
</head>
<body>
    <section>
        <h1>APIのテストページだよ。</h1>
            <form class="fetchForm">
              ボタンを押すとAPIと接続しようとしてくれます。<br>
              押してね。
                <!-- <input type="text" name="name" size="30" maxlength="30" class="name"> -->
                <input type="button" value="送信" class="btn">      
            </form>
    </section>
    <script>

      const ID1 = '2twhynojr3';
      const AREA = 'ap-northeast-1';
      const URL = `https://${ID1}.execute-api.${AREA}.amazonaws.com/dev/`;
      const KEY = 'OjwoF3m0l20OFidHsRea3ptuQRfQL10ahbEtLa';

      const headers = {
          'x-api-key': `A${KEY}s`,
          'Content-Type': 'application/json'
      };

      const fetchForm = document.querySelector('.fetchForm');
      const btn = document.querySelector('.btn');
      // const url = 'https://jsonplaceholder.typicode.com/posts/';

      const postFetch = () => {
          var text = 'Eisu 0 0 0 0 0 0 0 0 0';
          var data = JSON.stringify({
            uid: '11111',
            test: 'test',
            keys: text
          });
          console.log(data);
        
          fetch(URL, {
              method: 'POST',
              headers: headers,
              body: data
          }).then((response) => {
              if(!response.ok) {
                  console.log('error!');
              } 
              console.log('ok!');
              return response.json();
          }).then((data)  => {
              console.log(data);
          }).catch((error) => {
              console.log(error);
          });
      };

      btn.addEventListener('click', postFetch, false);
    </script>
</body>
</html>